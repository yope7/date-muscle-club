(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[918],{56104:(e,t,r)=>{"use strict";let s;r.d(t,{db:()=>d,j:()=>o});var a=r(23915),l=r(16203),i=r(35317);let n={apiKey:"***REMOVED***B3VrSH5rtQqm2C0vPVAubhZxXGZgwfLbg",authDomain:"date-muscle-club.firebaseapp.com",projectId:"date-muscle-club",storageBucket:"date-muscle-club.firebasestorage.app",messagingSenderId:"148397492251",appId:"1:148397492251:web:49ed3676e84a36387bd0be"};console.log("Firebase Config:",{...n,apiKey:n.apiKey?"***":void 0}),0===(0,a.Dk)().length?(console.log("Initializing new Firebase app"),s=(0,a.Wp)(n)):(console.log("Using existing Firebase app"),s=(0,a.Dk)()[0]);let o=(0,l.xI)(s),d=(0,i.aU)(s);console.log("Firebase initialized with:",{app:s.name,auth:o.app.name,db:d.app.name})},66681:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(12115),a=r(16203),l=r(56104);let i=(0,r(65453).v)(e=>({user:null,loading:!0,error:null,signInWithGoogle:async()=>{e({loading:!0,error:null});let t=new a.HF;try{await (0,a.df)(l.j,t)}catch(t){console.error("Error signing in with Google:",t),"auth/popup-closed-by-user"===t.code?e({error:"ログインがキャンセルされました"}):"auth/popup-blocked"===t.code?e({error:"ポップアップがブロックされています。ブラウザの設定を確認してください"}):e({error:"ログインに失敗しました。もう一度お試しください"})}finally{e({loading:!1})}},signInAsGuest:async()=>{e({loading:!0,error:null});try{await (0,a.zK)(l.j)}catch(t){console.error("Error signing in as guest:",t),e({error:"ゲストログインに失敗しました"})}finally{e({loading:!1})}},signOut:async()=>{e({loading:!0,error:null});try{await (0,a.CI)(l.j)}catch(t){console.error("Error signing out:",t),e({error:"ログアウトに失敗しました"})}finally{e({loading:!1})}},signIn:async()=>{e({loading:!0,error:null});let t=new a.HF;try{await (0,a.df)(l.j,t)}catch(t){console.error("Error signing in:",t),"auth/popup-closed-by-user"===t.code?e({error:"ログインがキャンセルされました"}):"auth/popup-blocked"===t.code?e({error:"ポップアップがブロックされています。ブラウザの設定を確認してください"}):e({error:"ログインに失敗しました。もう一度お試しください"})}finally{e({loading:!1})}},clearError:()=>e({error:null})})),n=()=>{let[e,t]=(0,s.useState)(i.getState());return(0,s.useEffect)(()=>{let e=i.subscribe(t);return()=>e()},[]),(0,s.useEffect)(()=>{let e=(0,a.hg)(l.j,e=>{i.setState({user:e,loading:!1})});return()=>e()},[]),e};n.getState=i.getState},78858:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ee});var s=r(95155),a=r(12115),l=r(54581),i=r(700),n=r(14426),o=r(68534),d=r(56278),c=r(54492),u=r(99927),x=r(71977),h=r(18407),j=r(29267),A=r(18096),m=r(66681),g=r(35317),p=r(56104),y=r(830),f=r(58885);let v=e=>{let{workouts:t}=e,r=t.length,a=t.reduce((e,t)=>e+t.sets.length,0),n=t.reduce((e,t)=>e+t.sets.reduce((e,t)=>e+t.reps,0),0),o=Math.max(...t.flatMap(e=>e.sets.map(e=>e.weight))),d=t[0],c=d?(0,y.GP)(d.date.toDate(),"yyyy年M月d日",{locale:f.ja}):"なし";return(0,s.jsxs)(l.A,{sx:{p:2},children:[(0,s.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"トレーニング統計"}),(0,s.jsxs)(l.A,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",sm:"repeat(4, 1fr)"},gap:2},children:[(0,s.jsxs)(h.A,{sx:{p:2,textAlign:"center"},children:[(0,s.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",children:"総トレーニング回数"}),(0,s.jsx)(i.A,{variant:"h4",children:r})]}),(0,s.jsxs)(h.A,{sx:{p:2,textAlign:"center"},children:[(0,s.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",children:"総セット数"}),(0,s.jsx)(i.A,{variant:"h4",children:a})]}),(0,s.jsxs)(h.A,{sx:{p:2,textAlign:"center"},children:[(0,s.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",children:"総レップ数"}),(0,s.jsx)(i.A,{variant:"h4",children:n})]}),(0,s.jsxs)(h.A,{sx:{p:2,textAlign:"center"},children:[(0,s.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",children:"最高重量"}),(0,s.jsxs)(i.A,{variant:"h4",children:[o,"kg"]})]})]}),(0,s.jsx)(l.A,{sx:{mt:2,textAlign:"center"},children:(0,s.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["最終トレーニング: ",c]})})]})};var b=r(16950),w=r(97644),k=r(72132),E=r(37223),S=r(88962),I=r(83540),C=r(56965),D=r(94754),U=r(96025),W=r(16238),M=r(94517),B=r(24026),F=r(21374);let P=e=>{let{workouts:t}=e,[r,n]=(0,a.useState)("1month"),o=(0,a.useMemo)(()=>{let e,s=new Date;switch(r){case"1week":e=(0,k.e)(s,7);break;case"1month":e=(0,E.a)(s,1);break;case"3months":e=(0,E.a)(s,3);break;default:return t}return t.filter(t=>{let r=t.date.toDate();return(0,S.f)(r)?r>=e:(console.warn("Invalid date found:",r),!1)}).sort((e,t)=>e.date.toDate().getTime()-t.date.toDate().getTime())},[t,r]),d=(0,a.useMemo)(()=>o.map(e=>{let t=e.date.toDate();if(!(0,S.f)(t))return console.warn("Invalid date in chart data:",t),null;let r=Math.max(...e.sets.map(e=>e.weight)),s=e.sets.reduce((e,t)=>e+t.weight*t.reps,0),a=e.sets.length,l=e.sets.reduce((e,t)=>e+t.reps,0)/a;return{date:(0,y.GP)(t,"M/d",{locale:f.ja}),maxWeight:r,totalVolume:s,totalSets:a,avgReps:l}}).filter(Boolean),[o]);return(0,s.jsxs)(l.A,{sx:{p:2},children:[(0,s.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"トレーニンググラフ"}),(0,s.jsx)(l.A,{sx:{mb:2},children:(0,s.jsxs)(b.A,{value:r,exclusive:!0,onChange:(e,t)=>t&&n(t),size:"small",children:[(0,s.jsx)(w.A,{value:"1week",children:"1週間"}),(0,s.jsx)(w.A,{value:"1month",children:"1ヶ月"}),(0,s.jsx)(w.A,{value:"3months",children:"3ヶ月"})]})}),(0,s.jsxs)(h.A,{sx:{p:2},children:[(0,s.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"最高重量の推移"}),(0,s.jsx)(I.u,{width:"100%",height:300,children:(0,s.jsxs)(C.b,{data:d,children:[(0,s.jsx)(D.d,{strokeDasharray:"3 3"}),(0,s.jsx)(U.W,{dataKey:"date"}),(0,s.jsx)(W.h,{}),(0,s.jsx)(M.m,{}),(0,s.jsx)(B.s,{}),(0,s.jsx)(F.N,{type:"monotone",dataKey:"maxWeight",stroke:"#8884d8",name:"最高重量 (kg)"})]})})]}),(0,s.jsxs)(h.A,{sx:{p:2},children:[(0,s.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"総挙上量の推移"}),(0,s.jsx)(I.u,{width:"100%",height:300,children:(0,s.jsxs)(C.b,{data:d,children:[(0,s.jsx)(D.d,{strokeDasharray:"3 3"}),(0,s.jsx)(U.W,{dataKey:"date"}),(0,s.jsx)(W.h,{}),(0,s.jsx)(M.m,{}),(0,s.jsx)(B.s,{}),(0,s.jsx)(F.N,{type:"monotone",dataKey:"totalVolume",stroke:"#82ca9d",name:"総挙上量 (kg)"})]})})]}),(0,s.jsxs)(h.A,{sx:{p:2},children:[(0,s.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"セット数と平均回数"}),(0,s.jsx)(I.u,{width:"100%",height:300,children:(0,s.jsxs)(C.b,{data:d,children:[(0,s.jsx)(D.d,{strokeDasharray:"3 3"}),(0,s.jsx)(U.W,{dataKey:"date"}),(0,s.jsx)(W.h,{yAxisId:"left"}),(0,s.jsx)(W.h,{yAxisId:"right",orientation:"right"}),(0,s.jsx)(M.m,{}),(0,s.jsx)(B.s,{}),(0,s.jsx)(F.N,{yAxisId:"left",type:"monotone",dataKey:"totalSets",stroke:"#ffc658",name:"セット数"}),(0,s.jsx)(F.N,{yAxisId:"right",type:"monotone",dataKey:"avgReps",stroke:"#ff8042",name:"平均回数"})]})})]})]})};var J=r(92302),K=r(42663),O=r(3127),G=r(89990),_=r(63148),N=r(99204),z=r(84567),Q=r(4220),H=r(35726);let T=()=>{let{user:e}=(0,m.A)(),[t,r]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[u,x]=(0,a.useState)(null),[j,A]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!(null==e?void 0:e.email))return;let t=(0,g.P)((0,g.rJ)(p.db,"invites"),(0,g._M)("toEmail","==",e.email),(0,g._M)("status","==","pending")),s=(0,g.aQ)(t,e=>{let t=[];e.forEach(e=>{var r,s;let a=e.data();t.push({id:e.id,fromUserId:a.fromUserId,fromUserEmail:a.fromUserEmail,toEmail:a.toEmail,status:a.status,createdAt:(null==(r=a.createdAt)?void 0:r.toDate())||new Date,updatedAt:(null==(s=a.updatedAt)?void 0:s.toDate())||new Date})}),r(t),c(!1)},e=>{console.error("Error fetching invites:",e),x("招待の取得に失敗しました"),c(!1)});return()=>s()},[null==e?void 0:e.email]);let y=async(t,s)=>{if(e)try{let a=(0,g.H9)(p.db,"invites",t),l=await (0,g.x7)(a);if(!l.exists())throw Error("招待が見つかりません");let i=l.data();await (0,g.mZ)(a,{status:s?"accepted":"rejected",updatedAt:(0,g.O5)()}),s?(await (0,g.gS)((0,g.rJ)(p.db,"shares"),{fromUserId:i.fromUserId,toUserId:e.uid,fromUserEmail:i.fromUserEmail,toUserEmail:e.email,createdAt:(0,g.O5)(),updatedAt:(0,g.O5)()}),A("招待を承認しました")):A("招待を拒否しました"),r(e=>e.filter(e=>e.id!==t)),setTimeout(()=>{A(null)},3e3)}catch(e){console.error("Error handling invite:",e),x("招待の処理に失敗しました")}};return d?(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,s.jsx)(n.A,{})}):u?(0,s.jsx)(J.A,{severity:"error",sx:{m:2},children:u}):0===t.length?(0,s.jsx)(l.A,{sx:{p:2},children:(0,s.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"保留中の招待はありません"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.A,{sx:{mt:2},children:(0,s.jsx)(_.A,{children:t.map(e=>(0,s.jsxs)(N.Ay,{secondaryAction:(0,s.jsxs)(l.A,{children:[(0,s.jsx)(o.A,{color:"primary",onClick:()=>y(e.id,!0),sx:{mr:1},children:"承認"}),(0,s.jsx)(o.A,{color:"error",onClick:()=>y(e.id,!1),children:"拒否"})]}),children:[(0,s.jsx)(z.A,{children:(0,s.jsx)(K.A,{children:e.fromUserEmail[0].toUpperCase()})}),(0,s.jsx)(Q.A,{primary:"".concat(e.fromUserEmail,"からの招待"),secondary:"送信日時: ".concat(e.createdAt.toLocaleString("ja-JP"))})]},e.id))})}),(0,s.jsx)(H.A,{open:!!j,autoHideDuration:3e3,onClose:()=>A(null),message:j})]})};var Z=r(86475),L=r(31747);let R=()=>{let{user:e}=(0,m.A)(),[t,r]=(0,a.useState)([]),[o,d]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),[x,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!e)return void d(!1);let t=(0,g.P)((0,g.rJ)(p.db,"shares"),(0,g._M)("toUserId","==",e.uid)),s=(0,g.P)((0,g.rJ)(p.db,"shares"),(0,g._M)("fromUserId","==",e.uid)),a=(0,g.aQ)(t,e=>{let t=[];e.forEach(e=>{let r=e.data();t.push({id:r.fromUserId,email:r.fromUserEmail})}),r(e=>[...e,...t]),d(!1)},e=>{console.error("Error fetching friends:",e),u("友達の取得に失敗しました"),d(!1)}),l=(0,g.aQ)(s,e=>{let t=[];e.forEach(e=>{let r=e.data();t.push({id:r.toUserId,email:r.toUserEmail})}),r(e=>[...e,...t]),d(!1)},e=>{console.error("Error fetching friends:",e),u("友達の取得に失敗しました"),d(!1)});return()=>{a(),l()}},[e]);let A=async e=>{try{let t=(0,g.P)((0,g.rJ)(p.db,"users",e,"workouts"),(0,g.My)("date","desc"),(0,g.AB)(30)),s=await (0,g.aQ)(t,t=>{var s;let a=[];t.forEach(e=>{let t=e.data();a.push({id:e.id,userId:t.userId,date:t.date,sets:t.sets,memo:t.memo||"",tags:t.tags||[],createdAt:t.createdAt,updatedAt:t.updatedAt})});let l={totalWorkouts:a.length,totalSets:a.reduce((e,t)=>e+t.sets.length,0),totalReps:a.reduce((e,t)=>e+t.sets.reduce((e,t)=>e+t.reps,0),0),maxWeight:Math.max(...a.flatMap(e=>e.sets.map(e=>e.weight))),lastWorkoutDate:null==(s=a[0])?void 0:s.date.toDate()};r(t=>t.map(t=>t.id===e?{...t,workouts:a,stats:l}:t))});return()=>s()}catch(e){console.error("Error fetching friend workouts:",e),u("友達のトレーニング記録の取得に失敗しました")}},y=e=>{x===e?j(null):(j(e),A(e))};return e?o?(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,s.jsx)(n.A,{})}):c?(0,s.jsx)(J.A,{severity:"error",sx:{m:2},children:c}):(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"保留中の招待"}),(0,s.jsx)(T,{}),(0,s.jsx)(i.A,{variant:"h6",sx:{mt:4,mb:2},children:"友達リスト"}),(0,s.jsx)(h.A,{sx:{p:2},children:0===t.length?(0,s.jsx)(i.A,{color:"text.secondary",children:"友達がいません。友達を招待して共有しましょう！"}):(0,s.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:t.map(e=>{var t;return(0,s.jsxs)(h.A,{sx:{p:2},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2,justifyContent:"space-between"},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,s.jsx)(K.A,{src:e.photoURL||void 0,children:(null==(t=e.displayName)?void 0:t[0])||e.email[0].toUpperCase()}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"subtitle1",children:e.displayName||e.email}),(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:e.email})]})]}),(0,s.jsx)(O.A,{onClick:()=>y(e.id),children:x===e.id?(0,s.jsx)(Z.A,{}):(0,s.jsx)(L.A,{})})]}),(0,s.jsx)(G.A,{in:x===e.id,children:e.stats?(0,s.jsxs)(l.A,{sx:{mt:2,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:2},children:[(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"総トレーニング回数"}),(0,s.jsxs)(i.A,{variant:"h6",children:[e.stats.totalWorkouts,"回"]})]}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"総セット数"}),(0,s.jsxs)(i.A,{variant:"h6",children:[e.stats.totalSets,"セット"]})]}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"総レップ数"}),(0,s.jsxs)(i.A,{variant:"h6",children:[e.stats.totalReps,"回"]})]}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"最高重量"}),(0,s.jsxs)(i.A,{variant:"h6",children:[e.stats.maxWeight,"kg"]})]}),e.stats.lastWorkoutDate&&(0,s.jsxs)(l.A,{sx:{gridColumn:"1 / -1"},children:[(0,s.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"最終トレーニング"}),(0,s.jsx)(i.A,{variant:"body1",children:e.stats.lastWorkoutDate.toLocaleDateString("ja-JP")})]})]}):(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:2},children:(0,s.jsx)(n.A,{size:24})})})]},e.id)})})})]}):(0,s.jsx)(l.A,{sx:{p:2},children:(0,s.jsx)(i.A,{variant:"body1",color:"text.secondary",children:"ログインが必要です"})})};var V=r(74199);let q=()=>{let{user:e}=(0,m.A)(),[t,r]=(0,a.useState)(!1),[h,j]=(0,a.useState)(""),[A,y]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[b,w]=(0,a.useState)(!1),k=()=>{r(!1),j(""),v(null),w(!1)},E=async()=>{if(e){if(!h)return void v("メールアドレスを入力してください");y(!0),v(null),w(!1);try{await (0,g.gS)((0,g.rJ)(p.db,"invites"),{fromUserId:e.uid,fromUserEmail:e.email,toEmail:h,status:"pending",createdAt:(0,g.O5)(),updatedAt:(0,g.O5)()}),w(!0),setTimeout(()=>{k()},2e3)}catch(e){v("招待の送信に失敗しました。もう一度お試しください。"),console.error("Invite error:",e)}finally{y(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{variant:"contained",color:"primary",onClick:()=>r(!0),sx:{mb:2},children:"友達を招待"}),(0,s.jsxs)(d.A,{open:t,onClose:k,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(c.A,{children:"友達を招待"}),(0,s.jsx)(u.A,{children:(0,s.jsxs)(l.A,{sx:{mt:2},children:[(0,s.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"共有したい友達のメールアドレスを入力してください。 招待が承認されると、あなたのトレーニング記録を閲覧できるようになります。"}),(0,s.jsx)(V.A,{fullWidth:!0,label:"メールアドレス",type:"email",value:h,onChange:e=>j(e.target.value),margin:"normal",error:!!f,helperText:f}),b&&(0,s.jsx)(J.A,{severity:"success",sx:{mt:2},children:"招待を送信しました！"})]})}),(0,s.jsxs)(x.A,{children:[(0,s.jsx)(o.A,{onClick:k,disabled:A,children:"キャンセル"}),(0,s.jsx)(o.A,{onClick:E,variant:"contained",color:"primary",disabled:A,children:A?(0,s.jsx)(n.A,{size:24}):"招待を送信"})]})]})]})};var X=r(81017),Y=r(19505);function $(e){let{children:t,value:r,index:a,...i}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),...i,children:r===a&&(0,s.jsx)(l.A,{sx:{p:3},children:t})})}function ee(){let{user:e}=(0,m.A)(),{resetData:t}=(0,X.Q)(),[r,y]=a.useState(0),[f,b]=(0,a.useState)(!1),[w,k]=(0,a.useState)([]),[E,S]=(0,a.useState)(!0),I=async()=>{await t(),b(!1)},C=()=>{b(!1)};return((0,a.useEffect)(()=>{if(!e)return void S(!1);let t=(0,g.P)((0,g.rJ)(p.db,"users",e.uid,"workouts"),(0,g.My)("date","desc")),r=(0,g.aQ)(t,e=>{let t=[];e.forEach(e=>{let r=e.data();t.push({id:e.id,userId:r.userId,date:r.date,sets:r.sets,memo:r.memo||"",tags:r.tags||[],createdAt:r.createdAt,updatedAt:r.updatedAt})}),k(t),S(!1)},e=>{console.error("Error fetching workouts:",e),S(!1)});return()=>r()},[e]),e)?E?(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,s.jsx)(n.A,{})}):(0,s.jsxs)(l.A,{sx:{p:3},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsx)(i.A,{variant:"h4",gutterBottom:!0,children:"マイページ"}),(0,s.jsxs)(l.A,{sx:{display:"flex",gap:2},children:[(0,s.jsx)(o.A,{variant:"outlined",color:"error",startIcon:(0,s.jsx)(Y.A,{}),onClick:()=>{b(!0)},disabled:E,children:"データをリセット"}),(0,s.jsx)(q,{})]})]}),(0,s.jsxs)(d.A,{open:f,onClose:C,children:[(0,s.jsx)(c.A,{children:"データのリセット"}),(0,s.jsx)(u.A,{children:(0,s.jsx)(i.A,{children:"すべてのトレーニング記録が削除されます。この操作は取り消せません。 本当にリセットしますか？"})}),(0,s.jsxs)(x.A,{children:[(0,s.jsx)(o.A,{onClick:C,children:"キャンセル"}),(0,s.jsx)(o.A,{onClick:I,color:"error",variant:"contained",children:"リセット"})]})]}),(0,s.jsx)(v,{workouts:w}),(0,s.jsxs)(h.A,{sx:{mt:3},children:[(0,s.jsxs)(j.A,{value:r,onChange:(e,t)=>{y(t)},"aria-label":"basic tabs example",centered:!0,children:[(0,s.jsx)(A.A,{label:"グラフ"}),(0,s.jsx)(A.A,{label:"友達"})]}),(0,s.jsx)($,{value:r,index:0,children:(0,s.jsx)(P,{workouts:w})}),(0,s.jsx)($,{value:r,index:1,children:(0,s.jsx)(R,{})})]})]}):(0,s.jsx)(l.A,{sx:{p:3},children:(0,s.jsx)(i.A,{variant:"h5",gutterBottom:!0,children:"ログインが必要です"})})}},81017:(e,t,r)=>{"use strict";r.d(t,{Q:()=>j});var s=r(65453),a=r(46786),l=r(66681),i=r(35317),n=r(56104);let o=e=>{let t=e.data();return{id:e.id,userId:t.userId,date:t.date,sets:t.sets,memo:t.memo||"",tags:t.tags||[],createdAt:t.createdAt,updatedAt:t.updatedAt}},d=async e=>{let t=(0,i.rJ)(n.db,"users",e,"workouts"),r=(0,i.P)(t,(0,i.My)("date","desc"));return(await (0,i.GG)(r)).docs.map(o)},c=async e=>{let t=(0,i.rJ)(n.db,"users",e.userId,"workouts"),r=await (0,i.gS)(t,{...e,createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()});return{...e,id:r.id}},u=async e=>{let t=(0,i.H9)(n.db,"users",e.userId,"workouts",e.id);await (0,i.mZ)(t,{...e,updatedAt:(0,i.O5)()})},x=async(e,t)=>{let r=(0,i.H9)(n.db,"users",e,"workouts",t);await (0,i.kd)(r)},h=async e=>{let t=(0,i.rJ)(n.db,"users",e,"workouts"),r=await (0,i.GG)(t),s=(0,i.wP)(n.db);r.docs.forEach(e=>{s.delete(e.ref)}),await s.commit()},j=(0,s.v)()((0,a.Zr)((e,t)=>({workouts:[],loading:!1,error:null,selectedDate:null,setSelectedDate:t=>e({selectedDate:t}),fetchWorkouts:async()=>{let t=l.A.getState().user;if(t){e({loading:!0,error:null});try{let r=await d(t.uid);e({workouts:r,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch workouts",loading:!1})}}},addWorkout:async t=>{if(l.A.getState().user){e({loading:!0,error:null});try{let r=await c(t);e(e=>({workouts:[...e.workouts,r],loading:!1}))}catch(t){e({error:t instanceof Error?t.message:"Failed to add workout",loading:!1})}}},updateWorkout:async t=>{if(l.A.getState().user){e({loading:!0,error:null});try{await u(t),e(e=>({workouts:e.workouts.map(e=>e.id===t.id?t:e),loading:!1}))}catch(t){e({error:t instanceof Error?t.message:"Failed to update workout",loading:!1})}}},deleteWorkout:async t=>{let r=l.A.getState().user;if(r){e({loading:!0,error:null});try{await x(r.uid,t),e(e=>({workouts:e.workouts.filter(e=>e.id!==t),loading:!1}))}catch(t){e({error:t instanceof Error?t.message:"Failed to delete workout",loading:!1})}}},resetData:async()=>{let t=l.A.getState().user;if(t){e({loading:!0,error:null});try{await h(t.uid),e({workouts:[],loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to reset data",loading:!1})}}}}),{name:"workout-storage",partialize:e=>({workouts:e.workouts,selectedDate:e.selectedDate})}))},83935:(e,t,r)=>{Promise.resolve().then(r.bind(r,78858))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,965,719,509,109,441,684,358],()=>t(83935)),_N_E=e.O()}]);